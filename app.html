<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KG</title>
    <style type="text/css">
        @import url('./static/css/main.css');
        @import url("./static/css/signin.css");
        @import url("./static/css/svg.css");
        @import url("./static/css/ldrawer.css");
        @import url("./static/css/graph.css");
        @import url("./static/css/rdrawer.css");
        #add-file-bar>input,#add-folder-bar>input{
            background-color:rgb(0, 0, 0);
            color:white;
            border:1px solid rgb(5, 181, 204);
            outline: none;
        }
        #add-file-bar:hover>input,#add-folder-bar:hover>input{
            border:1px solid rgb(3, 226, 255);
        }


        #add-prop-bar{
            margin:7px 10%;
        }
        #add-prop-bar>input{
            border:1px solid  rgb(1, 174, 255);
            width:100%;
        }
        /* #add-prop-bar:hover>input{
            background-color: rgb(1, 174, 255);

        } */
    </style>
</head>
<body >
    
    <div id ="app" >
        
        

        <div class="header">
            <div class="title">
                <div class="title-content">
                    {{currentFile?currentFile.fileName:"尚未选择文件"}}
                </div>
                <div class="userinfo">
                    <div class="username">
                        {{userInfo.username}}
                    </div>
                    <div  class = "useravatar">
                        <!-- <img :src="baseURL+'/image/'+userInfo.avatarURI" > -->

                        <svg width="40" height="40" viewBox="0 0 50 50">
                        <image :xlink:href="userInfo.avatarURI?baseURL+'/image/'+userInfo.avatarURI:'./static/avatar.png'" width="50" height="50"/>
                        <circle r="24" cx="25"  cy="25" class="circleclippath" /> 
                        
                        </svg>
                    </div>
                </div>
            </div>
            <div class="navigation">
                <div>工</div>
                <div>具</div>
                <div>栏</div>
                <div>最</div>
                <div>后</div>
                <div>再</div>
                <div>说</div>
                <div>啦</div>
            </div>
        </div>

        <div class="body">
            <div class="lbar">
                <div :class="[ldrawerContent+'btn',{focus:ldrawerContent==='filetree'}]" @click="clickLbar('filetree')">
                    <svg  viewBox="0 0 1024 1024" width="35" height="35">
                        <g id="filetreepath">
                        <path d="M880.104131 0v1024h-61.06734V45.290477H600.472838v978.709523h-56.443086V0h336.074379z" ></path>
                        <path d="M771.706203 80.652411h19.857086v943.347589h-19.857086zM727.7758 80.652411h19.857086v943.347589h-19.857086zM680.173197 80.652411h19.857086v943.347589h-19.857086zM636.242795 80.652411h19.857085v943.347589H636.242795zM143.895869 1024V0h336.074379v1024h-60.931332V45.290477H200.474963v978.709523H143.895869z" p-id="4941"></path>
                        <path d="M371.57232 80.652411h19.857086v943.347589h-19.857086zM327.641918 80.652411h19.857086v943.347589h-19.857086zM280.175322 80.652411h19.721079v943.347589h-19.721079zM236.24492 80.652411h19.721078v943.347589H236.24492z" ></path>
                        </g>
                        </svg>
                    <!-- <object data="./static/module.svg" type="image/svg+xml" width="50"></object> -->
                </div>
                <div :class="[ldrawerContent+'btn',{focus:ldrawerContent==='module'}]" @click="clickLbar('module')">
                    <svg  viewBox="0 0 1024 1024"  width="35" height="35">
                        <path id="modulepath" d="M183.24 688.67c10.91-1.65 22.19-2.06 32.67-5.18 30.37-9 38.33-32.33 15.52-53.75-31.07-29.2-65.62-54.65-98.69-81.71C114.84 533.36 97 518.54 79 504.08c-15.63-12.5-19.25-30.14-9.71-45 29.5-46.05 58.82-92.74 93.59-134.67 23.11-27.86 47.1-19.26 60.38 15.56 3.63 9.51 5.5 19.69 8.44 29.49 8.71 29.11 27.06 39.53 55 27.6 48-20.52 88.26-52 116-96.93 20-32.39 11.38-54.24-24.38-67.12-16.55-6.01-34.32-8.88-50.12-16.25-24.29-11.35-31-32.79-10.73-48.8 45.61-36.1 94.16-68.85 143.76-99.27 19.1-11.71 39.57 0 53.32 18.31 25.8 34.24 51.32 68.71 77.49 102.66 9.65 12.51 19.22 26.1 31.76 35.05 11.38 8.13 28.35 17.09 40 14.17 20.65-5.16 28.1-24.78 26.49-46.82-0.73-10-1.29-20.72 1.42-30.14 8.08-28.14 36.17-42.09 61.57-28.28 48.62 26.42 87.38 63.86 107.32 116.8 17.28 45.87 1.49 66.11-47.14 69.45-14 1-36.77 8.09-39 16.66-3.25 12.72 3.88 34.5 14.25 43.22C830.65 415 875.28 447 919.24 479.64c48.27 35.89 52.55 53.74 18.74 104.44-23.21 34.81-47.06 69.75-75 100.68-30.79 34.13-60.85 26.41-68.84-18.63-13.74-77.46-61.36-78.23-109-30.37-26.33 26.46-48.42 58.87-65.86 92.08-16.57 31.56-2.37 53.19 31.8 62.82 21.79 6.14 54 7.15 53.89 34.26-0.1 18.45-20.11 40.46-36.66 54.33-29.1 24.39-61.61 45-94.05 65-42 25.86-62 20.49-91.82-19.85C451 881.68 419.32 839.1 387.1 797a79 79 0 0 0-22.91-20.06c-22.41-12.82-40.65-2.33-42.72 23.46-4.1 51.07-38.45 72.53-85.41 50.84-48.55-22.42-81.23-62.07-102.14-110.3-14.72-33.94 7.08-56.43 49.32-52.27z" ></path>
                    </svg>
                </div>
                <div :class="[ldrawerContent+'btn',{focus:ldrawerContent==='search'}]"  @click="clickLbar('search')">
                    <svg  viewBox="0 0 1024 1024"  width="35" height="35">
                       <path id="searchpath" d="M756.7 183.4c-158.3-158.3-415-158.3-573.3 0s-158.3 415 0 573.3c142 142 362.9 156.2 521.2 43.5L844 939.6c26.3 26.3 69.3 26.3 95.6 0s26.3-69.3 0-95.6L800.2 704.7c112.7-158.4 98.5-379.3-43.5-521.3z m-95.5 477.8c-105.4 105.4-276.8 105.4-382.2 0S173.6 384.3 279 279s276.8-105.4 382.2 0 105.4 276.8 0 382.2z" ></path></svg>
                </div>
            </div>
            <transition name="ldrawer">
            <div class="ldrawer"  v-if="ldrawerContent!==null">
                <div class="filetree" @click="current= null;currentFileEle=null;" v-if="ldrawerContent==='filetree'">
                    <div class="control-bar">
                        <div class="add-file" @click.stop="showFileBar()">
                            <svg viewBox="0 0 1024 1024" width="20" height="20"><path id="fileaddpath" d="M862.155574 767.997312h-146.687486v-155.954654a35.839875 35.839875 0 0 0-9.881566-25.497511 31.692689 31.692689 0 0 0-23.961516-10.495963 31.692689 31.692689 0 0 0-24.012716 10.495963 35.839875 35.839875 0 0 0-9.881565 25.497511v156.005854H508.569612a31.692689 31.692689 0 0 0-23.961516 10.495963 35.839875 35.839875 0 0 0-9.881566 25.497511 35.839875 35.839875 0 0 0 9.881566 25.497511 31.692689 31.692689 0 0 0 23.961516 10.495963h139.161113v147.967482a35.839875 35.839875 0 0 0 9.881565 25.497511 31.692689 31.692689 0 0 0 24.012716 10.495963c9.369567 0 17.407939-3.481588 23.961516-10.495963a35.839875 35.839875 0 0 0 9.881566-25.497511v-147.967482h146.687486c9.420767 0 17.407939-3.532788 23.961517-10.495963a35.839875 35.839875 0 0 0 9.881565-25.497511 35.839875 35.839875 0 0 0-9.881565-25.497511 31.692689 31.692689 0 0 0-23.961517-10.495963z m26.419108-510.615813L682.495403 24.627114l-22.527921-24.524714H193.537115c-8.70397 0-18.431935-0.511998-26.931106 0.870397A42.342252 42.342252 0 0 0 140.391701 15.359946c-14.38715 16.281543-12.287957 36.710272-12.287957 56.729402v879.86892c0 20.01913-2.303992 41.676654 12.287957 56.831801 14.591949 15.155147 24.371115 15.155147 43.161449 15.155147H440.832249c9.420767 0 17.407939-3.481588 24.012716-10.495963a35.839875 35.839875 0 0 0 9.881565-25.497511 35.839875 35.839875 0 0 0-9.881565-25.497511 31.692689 31.692689 0 0 0-24.012716-10.495963H196.865103L196.557904 69.836556h372.478696v183.960956c0 20.01913 7.782373 38.041467 20.01913 50.995021 12.287957 12.953555 29.183898 20.991927 47.974232 20.991927h191.231331v214.27125a35.839875 35.839875 0 0 0 9.881565 25.497511 31.692689 31.692689 0 0 0 23.961517 10.495963c9.420767 0 17.407939-3.532788 24.012716-10.495963a35.839875 35.839875 0 0 0 9.830365-25.497511V280.319019l0.0512-14.28475-7.423974-8.65277z m-247.653533-8.806369c-2.099193-2.713591-3.379188-7.475174-3.839987-14.33595V77.823728l156.620252 175.973784H653.311505c-6.143978-0.819197-10.239964-2.559991-12.390356-5.273582z" fill="#2c2c2c" p-id="995"></path></svg>
                        </div>
                        <div class="add-folder" @click.stop="showFolderBar()">
                            <svg viewBox="0 0 1024 1024" width="20" height="20"><path class="folderaddpath" d="M794.1632 481.7408c19.3024 0 34.9184 15.3088 34.9184 34.2016v151.7568h155.2384c19.3536 0 35.0208 15.36 35.0208 34.2016a34.6112 34.6112 0 0 1-35.0208 34.1504l-155.2384-0.0512v151.808c0 18.944-15.616 34.2528-34.9184 34.2528a34.56 34.56 0 0 1-34.9184-34.2528l-0.0512-151.808h-155.1872a34.6112 34.6112 0 0 1-35.0208-34.0992c0-18.8928 15.6672-34.1504 35.0208-34.1504l155.1872-0.0512v-151.7568c0-18.8928 15.6672-34.2016 34.9696-34.2016zM72.5504 102.4l313.1392 0.1024c22.016 1.4336 40.0896 7.168 53.6064 18.944 11.5712 10.1376 20.0704 23.6544 26.5216 41.2672l19.456 59.904a33.5872 33.5872 0 0 1 1.4336 6.4512h502.272c19.3536 0 35.0208 15.3088 35.0208 34.1504v183.296a34.6112 34.6112 0 0 1-35.0208 34.1504 34.6112 34.6112 0 0 1-34.9696-34.1504V297.3696H69.9904v530.8416c0.2048 10.752 0.1024 15.5136 2.56 19.0976 1.8944 2.8672 3.4304 3.4304 7.68 3.584h458.5984c19.3024 0 34.9696 15.2576 34.9696 34.1504a34.6112 34.6112 0 0 1-34.9696 34.1504H80.7424l-5.9904-0.512c-27.4432-4.608-48.128-14.848-60.2624-33.4848-9.728-15.0016-14.1312-33.6896-14.4896-56.4736V263.0144l0.1536-93.2864c1.8432-18.176 7.936-33.792 19.2512-45.824 12.4928-13.3632 29.952-19.968 53.1456-21.504z m2.4064 68.2496c-4.3008 0.256-4.608 1.2288-4.9152 2.4064l-0.0512 56.0128h343.9104l-14.4384-44.544c-2.3552-6.4512-4.3008-10.1888-6.8608-12.1344-2.5088-1.9456-3.7888-1.2288-9.3184-1.6896l-308.3264-0.0512z" ></path></svg>
                        </div>
                        <div class="delete" @click.stop="deleteFile()">
                            <svg viewBox="0 0 1024 1024" width="20" height="20">
                                <g class="deletepath" >
                                <path d="M966.128 181.12H840.96c-0.168 0-0.32-0.096-0.488-0.096-0.16 0-0.312 0.096-0.48 0.096H184.064c-0.176 0-0.32-0.096-0.48-0.096-0.16 0-0.304 0.096-0.48 0.096H57.872a32.6 32.6 0 1 0 0 65.208h93.104v651.928c0 69.32 56.392 125.744 125.712 125.744h470.688c69.32 0 125.712-56.424 125.712-125.744V246.328h93.04a32.6 32.6 0 1 0 0-65.208z m-158.256 717.136c0 33.376-27.136 60.528-60.504 60.528H276.688c-33.352 0-60.496-27.16-60.496-60.528V246.328h591.68v651.928z"  ></path>
                                <path d="M346.488 814.744a32.608 32.608 0 0 0 32.608-32.608V422.888a32.6 32.6 0 0 0-65.216 0v359.24a32.6 32.6 0 0 0 32.608 32.616zM512 814.744a32.6 32.6 0 0 0 32.608-32.608V422.888a32.6 32.6 0 0 0-65.216 0v359.24A32.6 32.6 0 0 0 512 814.744zM677.544 814.744a32.584 32.584 0 0 0 32.6-32.608V422.888c0-18.008-14.576-32.6-32.6-32.6s-32.608 14.592-32.608 32.6v359.24a32.592 32.592 0 0 0 32.608 32.616zM318.848 157.6a32.608 32.608 0 0 0 32.608-32.6c0-23.808 64.048-59.792 160.576-59.792 96.512 0 160.544 35.984 160.544 59.792a32.6 32.6 0 0 0 32.608 32.6 32.592 32.592 0 0 0 32.6-32.6C737.792 53.736 640.736 0 512.032 0 383.312 0 286.24 53.736 286.24 125a32.608 32.608 0 0 0 32.608 32.6z" ></path>
                                </g>
                            </svg>
                        </div>
                        <div class="refresh" @click.stop="requestFiles()">
                            <svg viewBox="0 0 1024 1228" width="20" height="20">
                                <path id='refreshpath' d="M846.8 607.8C838.6 779.9 695.3 917 519.8 917 339 917 192.4 771.6 192.4 592.1c0-174.1 138.1-316.3 311.5-324.5v154.5l343-185.6L504 20v154.7C278.9 183 99 366.7 99 592.1c0 230.7 188.5 417.7 420.9 417.7 227.2 0 412.3-178.6 420.6-402h-93.7z m0 0"  ></path>
                            </svg>
                        </div>
                    </div>
                    <div>
                        <file-tree-item v-for="file in getFileChildren(null)" :fileobj="file"></file-tree-item>
                    </div>
                </div>
                <div class="module"   v-if="ldrawerContent==='module'">
                    <!-- TODO  模板分类管理-->
                    <div class="modulegroup">
                        <div class="control-bar">
                            <div @mousewheel="scrollmodulegrouptag($event)" class="modulegroup-tag-area">
                                <div class="module-group-path" @click="clickModuleGroup(null)"><span>#</span>/</div>
                                <div v-for="group in currentModuleGroupPath" class="module-group-path" @click="clickModuleGroup(group)"><span>{{group.groupName}}</span>/</div>

                            </div>
                            <div class="control-btn-area">
                                <div id="back-to-parent-group">
                                    <svg  viewBox="0 0 1317 1024"  width="20" height="20">
                                        <g class="backparent">
                                        <path d="M414.730226 749.92632a33.98988 33.98988 0 0 1-24.101553-9.982068L49.761207 399.076787A34.0751 34.0751 0 0 1 39.769197 374.969552a34.052375 34.052375 0 0 1 9.99201-24.100133L390.628673 10.000533c13.309898-13.315579 34.89889-13.315579 48.208788 0 13.309898 13.309898 13.309898 34.893209 0 48.208788L122.060186 374.953928l316.777275 316.733245a34.090723 34.090723 0 0 1-24.107235 58.193697v0.04545z m0 0" ></path>
                                        <path d="M1062.350289 1022.623702c-15.629294-0.005681-29.250244-10.646782-33.028318-25.810209C867.782335 350.724545 118.452552 408.297559 110.890723 408.946649c-18.758278 1.626276-35.280959-12.256014-36.905814-31.014292-1.631957-18.758278 12.256014-35.280959 31.014292-36.905815 8.149845-0.788282 815.051221-62.566889 990.379405 639.247226a34.065158 34.065158 0 0 1-33.089392 42.359876l0.061075-0.009942z m0 0" ></path>
                                        </g>
                                    </svg>
                                </div>
                                <div id="add-modulegroup">
                                    <svg viewBox="0 0 1024 1024" width="20" height="20">
                                        <path class="folderaddpath" d="M794.1632 481.7408c19.3024 0 34.9184 15.3088 34.9184 34.2016v151.7568h155.2384c19.3536 0 35.0208 15.36 35.0208 34.2016a34.6112 34.6112 0 0 1-35.0208 34.1504l-155.2384-0.0512v151.808c0 18.944-15.616 34.2528-34.9184 34.2528a34.56 34.56 0 0 1-34.9184-34.2528l-0.0512-151.808h-155.1872a34.6112 34.6112 0 0 1-35.0208-34.0992c0-18.8928 15.6672-34.1504 35.0208-34.1504l155.1872-0.0512v-151.7568c0-18.8928 15.6672-34.2016 34.9696-34.2016zM72.5504 102.4l313.1392 0.1024c22.016 1.4336 40.0896 7.168 53.6064 18.944 11.5712 10.1376 20.0704 23.6544 26.5216 41.2672l19.456 59.904a33.5872 33.5872 0 0 1 1.4336 6.4512h502.272c19.3536 0 35.0208 15.3088 35.0208 34.1504v183.296a34.6112 34.6112 0 0 1-35.0208 34.1504 34.6112 34.6112 0 0 1-34.9696-34.1504V297.3696H69.9904v530.8416c0.2048 10.752 0.1024 15.5136 2.56 19.0976 1.8944 2.8672 3.4304 3.4304 7.68 3.584h458.5984c19.3024 0 34.9696 15.2576 34.9696 34.1504a34.6112 34.6112 0 0 1-34.9696 34.1504H80.7424l-5.9904-0.512c-27.4432-4.608-48.128-14.848-60.2624-33.4848-9.728-15.0016-14.1312-33.6896-14.4896-56.4736V263.0144l0.1536-93.2864c1.8432-18.176 7.936-33.792 19.2512-45.824 12.4928-13.3632 29.952-19.968 53.1456-21.504z m2.4064 68.2496c-4.3008 0.256-4.608 1.2288-4.9152 2.4064l-0.0512 56.0128h343.9104l-14.4384-44.544c-2.3552-6.4512-4.3008-10.1888-6.8608-12.1344-2.5088-1.9456-3.7888-1.2288-9.3184-1.6896l-308.3264-0.0512z" ></path>
                                    </svg>
                                </div>
                                <div id="remove-modulegroup">
                                    <svg viewBox="0 0 1024 1024" width="20" height="20">
                                        <g class="deletepath" >
                                        <path d="M966.128 181.12H840.96c-0.168 0-0.32-0.096-0.488-0.096-0.16 0-0.312 0.096-0.48 0.096H184.064c-0.176 0-0.32-0.096-0.48-0.096-0.16 0-0.304 0.096-0.48 0.096H57.872a32.6 32.6 0 1 0 0 65.208h93.104v651.928c0 69.32 56.392 125.744 125.712 125.744h470.688c69.32 0 125.712-56.424 125.712-125.744V246.328h93.04a32.6 32.6 0 1 0 0-65.208z m-158.256 717.136c0 33.376-27.136 60.528-60.504 60.528H276.688c-33.352 0-60.496-27.16-60.496-60.528V246.328h591.68v651.928z"  ></path>
                                        <path d="M346.488 814.744a32.608 32.608 0 0 0 32.608-32.608V422.888a32.6 32.6 0 0 0-65.216 0v359.24a32.6 32.6 0 0 0 32.608 32.616zM512 814.744a32.6 32.6 0 0 0 32.608-32.608V422.888a32.6 32.6 0 0 0-65.216 0v359.24A32.6 32.6 0 0 0 512 814.744zM677.544 814.744a32.584 32.584 0 0 0 32.6-32.608V422.888c0-18.008-14.576-32.6-32.6-32.6s-32.608 14.592-32.608 32.6v359.24a32.592 32.592 0 0 0 32.608 32.616zM318.848 157.6a32.608 32.608 0 0 0 32.608-32.6c0-23.808 64.048-59.792 160.576-59.792 96.512 0 160.544 35.984 160.544 59.792a32.6 32.6 0 0 0 32.608 32.6 32.592 32.592 0 0 0 32.6-32.6C737.792 53.736 640.736 0 512.032 0 383.312 0 286.24 53.736 286.24 125a32.608 32.608 0 0 0 32.608 32.6z" ></path>
                                        </g>
                                    </svg>
                                </div>
                            </div>
                        </div>
                        <div>
                            <module-group-item v-for="group in subModuleGroups" :groupobj="group"></module-group-item>
                        </div>
                    </div>
                    <div class="node-module-group">
                        <div class="control-bar" @click="visibleHandler.nodeModuleTag = !visibleHandler.nodeModuleTag">
                            <div id="add-module" @click.stop="postmodule()">
                                <svg viewBox="0 0 1024 1024" height="20" width="20">
                                    <path class="pluspath" d="M858.88 448H576V167.68a64 64 0 0 0-128 0V448H169.6a64 64 0 0 0 0 128H448v280.32a64 64 0 0 0 128 0V576h280.32a64 64 0 0 0 0-128z" ></path>
                                </svg>
                            </div>
                            <div id="remove-module" @click.stop="deletemodule()">
                                <svg viewBox="0 0 1024 1024" height="20" width="20">
                                    <path class='minuspath' d="M972.8 494.933333c0 22.755556-17.066667 45.511111-45.511111 45.511111H96.711111c-22.755556 0-45.511111-17.066667-45.511111-45.511111s17.066667-45.511111 45.511111-45.511111h836.266667c22.755556 0 39.822222 17.066667 39.822222 45.511111z"></path>
                                </svg>
                            </div>
                        </div>
                        <div v-show="visibleHandler.nodeModuleTag">
                            <module-item draggable="true"  v-for="module in currentNodeModules" :moduleobj="module"></module-item>
                        </div>  
                    </div>
                    <!-- TODO　关系模板显示位置 -->
                    <div class="rela-module-group">
                        <div class="control-bar" @click="visibleHandler.relaModuleTag = !visibleHandler.relaModuleTag">
                            <div id="add-rela-module" @click.stop="postmodule(true)">
                                <svg viewBox="0 0 1024 1024" height="20" width="20">
                                    <path class="pluspath" d="M858.88 448H576V167.68a64 64 0 0 0-128 0V448H169.6a64 64 0 0 0 0 128H448v280.32a64 64 0 0 0 128 0V576h280.32a64 64 0 0 0 0-128z" ></path>
                                </svg>
                            </div>
                            <div id="remove-rela-module" @click.stop="deletemodule(true)">
                                <svg viewBox="0 0 1024 1024" height="20" width="20">
                                    <path class='minuspath' d="M972.8 494.933333c0 22.755556-17.066667 45.511111-45.511111 45.511111H96.711111c-22.755556 0-45.511111-17.066667-45.511111-45.511111s17.066667-45.511111 45.511111-45.511111h836.266667c22.755556 0 39.822222 17.066667 39.822222 45.511111z"></path>
                                </svg>
                            </div>
                        </div>
                        <div v-show="visibleHandler.relaModuleTag">
                            <div  v-for="module in currentRelaModules"  @click.stop="clickRelaModule(module)">{{module.id}}-{{module.labelName}}- {{module.node}}</div>
                            
                        </div>
                    </div>
                </div>
                <div class="search" v-if="ldrawerContent==='search'">
a
                </div>
            </div>
            </transition>
            <!-- TODO @keyup.alt="saveAll($event)" on .graph-canvas not working -->
            <div class="graph-canvas" >
                <svg @dragover="canvasdragover($event)" @drop="canvasdrop($event)" width="2000" height="2000" viewBox="0 0 2000 2000" id="main">
                    <defs>
                        <marker id="arrow" viewBox="0 -5 10 10" refX="10" refY='0' orient="auto" markerWidth="13" markerHeight="13" xoverflow="visible" markerUnits="userSpaceOnUse">
                            <path d="M 0 -5 L 10 0 L 0 5" fill="rgb(0, 82, 121)" stroke="none"></path>
                        </marker>
                        <marker id="point" viewBox="-5 -5 10 10" refX="-10" refY='0' orient="auto" markerWidth="10" markerHeight="10" xoverflow="visible" markerUnits="userSpaceOnUse">
                            <circle r="5" cx="0" cy="0" fill="rgb(0, 82, 121)"></circle>
                        </marker>
                        <clipPath id="circlepath" clipPathUnits="objectBoundingBox">
                            <circle r=".5" cx=".5" cy=".5"></circle>
                        </clipPath>
                    </defs>
                    <g class="edgegroup"></g>
                    <g class="nodegroup"></g>
                </svg>
            </div>
            <div class="rdrawer" v-if="current &&( current===currentModule || current=== currentNode || current === currentRelation || current === currentRelationModule)">
                <div class="rd-module" v-if="current!==null && current===currentModule">
                    <div class="title-bar">
                        <div class="avatar-area">
                            <svg width="40" height="40" viewBox="0 0 50 50">
                                <image :xlink:href="current.avatarUri?baseURL+'/image/'+current.avatarUri:'./static/moduleavatar.png'" width="50" height="50"/>
                                <circle r="24" cx="25"  cy="25" class="circleclippath" /> 
                                
                            </svg>
                            <!-- <img :src="current.avatarUri?baseURL+'/image/'+current.avatarUri:'./static/moduleavatar.png'" > -->
                            <input @change="uploadimage($event)" class="upload-file" type="file" accept="image/png, image/jpeg, image/gif, image/jpg" name="image" >
                   
                        </div>
                        <div class="title-area">
                            <input class='textinput' type="text" v-model.trim="currentModule.labelName">
                        </div>
                    </div>
                    <div class="type-props">
                        <div class="type-prop-item">
                            <div>
                            <label for="m-describe">描述</label>
                            </div>
                            <textarea id="m-describe" v-model.trim="currentModule.describe"  placeholder="请输入模板描述信息"></textarea>
                        </div>
                        <!-- <div class="type-prop-item">
                            模板类型
                            <label  for="m-isnode-true">节点</label>
                            <input type="radio" id="m-isnode-true" :value="true" v-model="currentModule.node"  ></input>
                            <label for="m-isnode-false">关系</label>
                            <input type="radio" id="m-isnode-false" :value="false" v-model="currentModule.node"  ></input>
                        
                        </div>     -->
                    </div>
                    <div class="user-prop-controller">
                        <div id="add-module-prop" @click="showPropBar()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class="pluspath" d="M858.88 448H576V167.68a64 64 0 0 0-128 0V448H169.6a64 64 0 0 0 0 128H448v280.32a64 64 0 0 0 128 0V576h280.32a64 64 0 0 0 0-128z" ></path>
                            </svg>
                        </div>
                        <div id="remove-module-prop" @click="deleteProp()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class='minuspath' d="M972.8 494.933333c0 22.755556-17.066667 45.511111-45.511111 45.511111H96.711111c-22.755556 0-45.511111-17.066667-45.511111-45.511111s17.066667-45.511111 45.511111-45.511111h836.266667c22.755556 0 39.822222 17.066667 39.822222 45.511111z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="user-props">
                        <user-prop-item class="user-prop-item" v-for="(prop,name,index) in currentModule.properties" :index="index" :objprop.sync="prop.default" :propcontraint.sync="prop.contraint"><div class="user-prop-name" @click="clickProp(name)">{{name}}</div></user-prop-item>
                    </div>
                    <div >
                        <div id="rd-module-btn" @click="patchmodule()">
                            {{currentModule.id?'修改':'修改'}}
                        </div>
                    </div>
                </div>
                <div class="rd-rela-module" v-if="current!==null && current===currentRelationModule" >
                    <div class="title-bar">
fffffffff
                    </div>
                    <div class="type-props">
                        <div class="type-prop-item">
                            <div>
                            <label for="m-rela-describe">描述</label>
                            </div>
                            <textarea id="m-rela--describe" v-model.trim="currentRelationModule.describe"  placeholder="请输入模板描述信息"></textarea>
                        </div>
                     
                    </div>
                    <div class="user-prop-controller">
                        <div id="add-rela-module-prop" @click="showPropBar()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class="pluspath" d="M858.88 448H576V167.68a64 64 0 0 0-128 0V448H169.6a64 64 0 0 0 0 128H448v280.32a64 64 0 0 0 128 0V576h280.32a64 64 0 0 0 0-128z" ></path>
                            </svg>
                        </div>
                        <div id="remove-rela-module-prop" @click="deleteProp()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class='minuspath' d="M972.8 494.933333c0 22.755556-17.066667 45.511111-45.511111 45.511111H96.711111c-22.755556 0-45.511111-17.066667-45.511111-45.511111s17.066667-45.511111 45.511111-45.511111h836.266667c22.755556 0 39.822222 17.066667 39.822222 45.511111z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="user-props">
                        <user-prop-item class="user-prop-item" v-for="(prop,name,index) in currentRelationModule.properties" :index="index" :objprop.sync="prop.default" :propcontraint.sync="prop.contraint"><div class="user-prop-name" @click="clickProp(name)">{{name}}</div></user-prop-item>
                    </div>
                    <div >
                        <div id="rd-rela-module-btn" @click="patchmodule(true)">
                            {{currentRelationModule.id?'修改':'修改'}}
                        </div>
                    </div>
                </div>
                <div class="rd-node" v-if="current!==null && current === currentNode">
                    <div class="title-bar">
                        <div v-if="currentNode.mainLabel" class="avatar-area">
                            <svg width="40" height="40" viewBox="0 0 50 50">
                                <image :xlink:href="moduleMap[currentNode.mainLabel]?(moduleMap[currentNode.mainLabel].avatarUri?baseURL+'/image/'+moduleMap[currentNode.mainLabel].avatarUri:'./static/moduleavatar.png'):'./static/moduleavatar.png'" width="50" height="50"/>
                                <circle r="24" cx="25"  cy="25" class="circleclippath" /> 
                                
                            </svg>                   
                        </div>
                        <div class="title-area">
                            {{currentNode.mainLabel}}
                        </div>
                    </div>
                    <div class="label-pool">
                        <input type="text" @change="appendNodeLabel($event)" value="" placeholder="标签">
                        <div>
                            <div :style="'background-color:rgb('+Math.floor(Math.random()*256)+','+ Math.floor(Math.random()*256)+','+ Math.floor(Math.random()*256)+')'" v-for="label in currentNode.labels">{{label}}</div>
                        </div>
                    </div>
                    <div class="user-prop-controller">
                        <div id="add-node-prop" @click="showPropBar()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class="pluspath" d="M858.88 448H576V167.68a64 64 0 0 0-128 0V448H169.6a64 64 0 0 0 0 128H448v280.32a64 64 0 0 0 128 0V576h280.32a64 64 0 0 0 0-128z" ></path>
                            </svg>
                        </div>
                        <div id="remove-node-prop" @click="deleteProp()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class='minuspath' d="M972.8 494.933333c0 22.755556-17.066667 45.511111-45.511111 45.511111H96.711111c-22.755556 0-45.511111-17.066667-45.511111-45.511111s17.066667-45.511111 45.511111-45.511111h836.266667c22.755556 0 39.822222 17.066667 39.822222 45.511111z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="user-props">
                        <user-prop-item class="user-prop-item" v-for="(prop,name,index) in currentNode.properties" :index="index" :objprop.sync="currentNode.properties[name]" ><div class="user-prop-name" @click="clickProp(name)">{{name}}</div></user-prop-item>
                    </div>
                    <div >
                        <div id="rd-node-btn" @click="addOrUpdateBtn()">
                            {{currentNode.id>=0?'修改':'添加'}}
                        </div>
                    </div>
                </div>

                <div class="rd-rela" v-if="current!==null && current === currentRelation">
                    <div class="title-bar">
                        <div class="title-area">
                            <input type="text" placeholder="关系名称" v-model="currentRelation.relaUnit.relationName">
                        </div>
                    </div>
                    <div class="user-prop-controller">
                        <div id="add-rela-prop" @click = "showPropBar()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class="pluspath" d="M858.88 448H576V167.68a64 64 0 0 0-128 0V448H169.6a64 64 0 0 0 0 128H448v280.32a64 64 0 0 0 128 0V576h280.32a64 64 0 0 0 0-128z" ></path>
                            </svg>
                        </div>
                        <div id="remove-rela-prop" @click="deleteProp()">
                            <svg viewBox="0 0 1024 1024" height="20" width="20">
                                <path class='minuspath' d="M972.8 494.933333c0 22.755556-17.066667 45.511111-45.511111 45.511111H96.711111c-22.755556 0-45.511111-17.066667-45.511111-45.511111s17.066667-45.511111 45.511111-45.511111h836.266667c22.755556 0 39.822222 17.066667 39.822222 45.511111z"></path>
                            </svg>
                        </div>
                    </div>
                    <div class="user-props">
                        <user-prop-item class="user-prop-item" v-for="(prop,name,index) in currentRelation.relaUnit.properties" :index="index" :objprop.sync="currentRelation.relaUnit.properties[name]" ><div class="user-prop-name" @click="clickProp(name)">{{name}}</div></user-prop-item>
                    </div>
                    <div >
                        <div id="rd-rela-btn"  @click="addOrUpdateBtn()">
                            {{currentRelation.relaUnit.id>=0?'修改':'添加'}}
                        </div>
                    </div>
                </div>
            </div>
            <!-- <div class="rbar">
                
            </div> -->
        </div>

       


        <div id="signin" style="display:none" v-show="visibleHandler.signinbox">
            <div>
            <div class="tab">
                <div @click="visibleHandler.islogin = true" :class="{'tabfocus':visibleHandler.islogin}">登 录</div>
                <div @click="visibleHandler.islogin = false" :class="{'tabfocus':!visibleHandler.islogin}">注 册</div>
            </div>
            <transition name="signcontent" mode="out-in">
            <!-- login  -->
            <div class="content" v-if="visibleHandler.islogin" key=1>
                <div>
                    <label for="uname">用户名  </label>
                    <input type="text"  id="uname" v-model="input.uname"  placeholder="请输入你的用户名">
                </div>
                <div>
                    <label for="pword">密  码  </label>
                    <input type="password"  id="pword" v-model="input.pword" placeholder="请输入密码">
                </div>
                <div :class="{warn:isSignboxWarn, log:true, error:classStatus.isSignboxError}">{{content.signWarn}}</div>
                <div>
                    <button @click="login">提 交</button>
                </div>
            </div>
            <!-- signin -->
            <div class="content" v-if="!visibleHandler.islogin" key=2>
                <div>
                    <label for="uname">用户名  </label>
                    <input type="text"  id="uname" v-model="input.uname"  placeholder="请输入你的用户名">
                </div>
                <div>
                    <label for="pword">密  码  </label>
                    <input type="password"  id="pword" v-model="input.pword" placeholder="请输入密码">
                </div>
                <div>
                    <label for="pwordrep">确认密码  </label>
                    <input type="password"  id="pwordrep" v-model="input.pwordrep" placeholder="请再次输入密码以确认">
                </div>
                <div :class="{warn:isSignboxWarn , log:true, error:classStatus.isSignboxError}">{{content.signWarn}}</div>
        
                <div>
                    <button @click = "signup">提 交</button>
                </div>
            </div>
            </transition>
            </div>
        </div>

    </div>

    <script src="./static/js/build/bundle.js"></script>
    <script>
      


    </script>
</body>
</html>



<!-- TODO add module group

带有层级关系的模板系统
__________________________________
| root/folder1/folder2/       <- |
——————————————————————————————————
| sub folder1                    |   
| sub folder2                    |
| sub folder3                    |   
| ...                            |
|________________________________|
| folder2下节点模板         +   - |
——————————————————————————————————
|                                |
|  + + + +    + + + +    + + + + |     
|  + + + +    + + + +    + + + + |
|  + + + +    + + + +    + + + + |
|                                |
|  + + + +    + + + +    + + + + |
|  + + + +    + + + +    + + + + |
|  + + + +    + + + +    + + + + |
|                                |               
——————————————————————————————————
| folder2下关系模板         +   - |
|————————————————————————————————|
|                                |
|  + + + +    + + + +    + + + + |     
|  + + + +    + + + +    + + + + |
|  + + + +    + + + +    + + + + |
|                                |
|  + + + +    + + + +    + + + + |
|  + + + +    + + + +    + + + + |
|  + + + +    + + + +    + + + + |
|                                |               
——————————————————————————————————
                    
-->

<!-- TODO realtionship module
    dasharray
    color
    start , mid , end marker: 双竖线 单竖线 圆点 右箭头 左箭头 圆点+单竖 圆点+双竖
    ifAnim
-->